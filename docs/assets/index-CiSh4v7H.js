const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-BDOhAIHw.js","./index-B-nbFw5B.js","./___vite-browser-external_commonjs-proxy-Buz2L0e0.js","./Texture--lNMEbwv.js","./imageRetrievalPoolManager-CQ2_YfAr.js","./index-DAH3nJ5Y.js","./index-MB1vDvr4.js","./dicomParser.min-CYxCOwbh.js"])))=>i.map(i=>d[i]);
(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function c(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(t){if(t.ep)return;t.ep=!0;const o=c(t);fetch(t.href,o)}})();const B="modulepreload",O=function(e,l){return new URL(e,l).href},I={},w=function(l,c,r){let t=Promise.resolve();if(c&&c.length>0){let y=function(i){return Promise.all(i.map(d=>Promise.resolve(d).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};const a=document.getElementsByTagName("link"),s=document.querySelector("meta[property=csp-nonce]"),p=s?.nonce||s?.getAttribute("nonce");t=y(c.map(i=>{if(i=O(i,r),i in I)return;I[i]=!0;const d=i.endsWith(".css"),g=d?'[rel="stylesheet"]':"";if(r)for(let f=a.length-1;f>=0;f--){const h=a[f];if(h.href===i&&(!d||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${g}`))return;const u=document.createElement("link");if(u.rel=d?"stylesheet":B,d||(u.as="script"),u.crossOrigin="",u.href=i,p&&u.setAttribute("nonce",p),document.head.appendChild(u),d)return new Promise((f,h)=>{u.addEventListener("load",f),u.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${i}`)))})}))}function o(a){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=a,window.dispatchEvent(s),!s.defaultPrevented)throw a}return t.then(a=>{for(const s of a||[])s.status==="rejected"&&o(s.reason);return l().catch(o)})},P=document.getElementById("dicomViewport"),N=document.getElementById("status"),M=document.getElementById("dicomFiles");let L,T,E;function m(e){N&&(N.textContent=e)}function b(e){return e?e.stack?e.stack:e.message?e.message:String(e):"Unknown error"}async function C(){m("Loading Cornerstone modules...");try{const e=await w(()=>import("./index-BDOhAIHw.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url),l=await w(()=>import("./index-DAH3nJ5Y.js"),__vite__mapDeps([5,1,2,3]),import.meta.url);E=await w(()=>import("./index-MB1vDvr4.js"),__vite__mapDeps([6,1,2,7,4]),import.meta.url);const c=await w(()=>import("./dicomParser.min-CYxCOwbh.js").then(S=>S.d),__vite__mapDeps([7,2]),import.meta.url),r=c.default??c,t=E.default??E;m("Initializing Cornerstone..."),await e.init(),await l.init(),t.init({dicomParser:r});const{addTool:o,ToolGroupManager:a,PanTool:s,ZoomTool:p,WindowLevelTool:y,StackScrollTool:i,LengthTool:d,Enums:g}=l;o(s),o(p),o(y),o(i),o(d);const u="re1",f="vp1";L=new e.RenderingEngine(u),L.enableElement({viewportId:f,type:e.Enums.ViewportType.STACK,element:P}),T=L.getViewport(f);const n=a.createToolGroup("tg1");n.addTool(i.toolName),n.addTool(y.toolName),n.addTool(s.toolName),n.addTool(p.toolName),n.addTool(d.toolName),n.addViewport(f,u);const v=g?.MouseBindings??null,_=g?.KeyboardBindings??null;v?(n.setToolActive(y.toolName,{bindings:[{mouseButton:v.Primary}]}),n.setToolActive(s.toolName,{bindings:[{mouseButton:v.Auxiliary}]}),n.setToolActive(p.toolName,{bindings:[{mouseButton:v.Secondary}]}),n.setToolActive(i.toolName,{bindings:[{mouseButton:v.Wheel}]}),_?.Shift!=null?n.setToolActive(d.toolName,{bindings:[{mouseButton:v.Primary,modifierKey:_.Shift}]}):n.setToolPassive(d.toolName)):(n.setToolActive(i.toolName),n.setToolActive(y.toolName),n.setToolPassive(s.toolName),n.setToolPassive(p.toolName),n.setToolPassive(d.toolName)),T.render(),m("Ready. Choose DICOM files (one series) to load.")}catch(e){console.error(e),m(`Initialization failed:
`+b(e))}}async function A(e){const l=Array.from(e||[]).filter(r=>r&&r.size>0);if(l.length===0)return;if(!T){m("Viewer not initialized yet. See error above.");return}const c=E?.default??E;if(!c?.wadouri?.fileManager?.add){m("DICOM loader not ready (wadouri.fileManager.add missing).");return}try{m("Indexing files...");const r=l.map(t=>c.wadouri.fileManager.add(t));m("Loading stack..."),await T.setStack(r),T.render(),m("Loaded "+r.length+" slices. Wheel scroll, left drag window/level, middle pan, right zoom.")}catch(r){console.error(r),m(`Load failed:
`+b(r)+`
Try selecting only one series.`)}}M?.addEventListener("change",async e=>A(e.target.files));P?.addEventListener("dragover",e=>{e.preventDefault()});P?.addEventListener("drop",async e=>{e.preventDefault(),A(e.dataTransfer.files)});C();export{w as _};
